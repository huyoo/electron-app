{"version":3,"sources":["h5.js"],"names":[],"mappings":"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","file":"h5-compile.js","sourcesContent":["'use strict';\r\n\r\n(function (win, factory) {\r\n    if (typeof define === 'function' && define.amd) {\r\n        define('gameManager', factory);\r\n    } else if (typeof exports === 'object') {\r\n        module.exports = factory();\r\n    } else {\r\n        win.GameManager = factory();\r\n    }\r\n})(window, function () {\r\n    var i;\r\n    function GameManager() {\r\n        this.version = '1.0';\r\n        this.def = {\r\n            content: tool.getDom(arguments[0]),\r\n            menu : tool.getDom('title'),\r\n            start : tool.getDom('start'),\r\n            repeat: tool.getDom('repeat'),\r\n            level: 1,\r\n            data: null,\r\n            score: 0,\r\n            hard: 3,\r\n            curtain: 0,//当前没有被找出的方块\r\n        };\r\n        this.init();\r\n    };\r\n\r\n    var proto = GameManager.prototype;\r\n    proto.constructor = GameManager;\r\n    /**\r\n     * 等待游戏开始\r\n     */\r\n    proto.waiting = function () {\r\n        var _this = this;\r\n        tool.addEvent(_this.def.start, 'click', function () {\r\n            tool.setAttr(_this.def.start.parentNode, { 'style' : 'display: none'});\r\n            tool.setAttr(_this.def.start.parentNode.parentNode, { 'style' : 'display: none' });\r\n            _this.init();\r\n        })\r\n    };\r\n    /**\r\n     * 初始化游戏界面\r\n     */\r\n    proto.init = function () {\r\n        var def = this.def;\r\n        def.data = this.getRandom(def.hard);\r\n        def.curtain = def.hard;\r\n        this.create(def, def.data);\r\n        def.level ===1 && this.addEvent(def);//事件委托后只生成一次监听程序\r\n        this.score(def);\r\n    };\r\n\r\n    //得分管理\r\n    proto.score = function () {\r\n        var arg = arguments[0];\r\n        if(!arg && arg !== 0){ return; }\r\n        var def = this.def;\r\n        if (typeof arg === 'object'){\r\n            arg.data.score = 0;\r\n            arg.data.level = 1;\r\n        }else if (!isNaN(arg)){\r\n            if(def.data[arg].isTarg){\r\n                def.score += def.hard;\r\n                --def.curtain;\r\n            }\r\n        }\r\n        tool.html(tool.getDom('level'), def.level);\r\n        tool.html(tool.getDom('score'), def.score +'');\r\n        this.data();\r\n    };\r\n\r\n    proto.data = function () {\r\n        var def = this.def, _this = this;\r\n        if (!def.curtain){\r\n            if (def.hard === def.level)\r\n                ++def.hard;\r\n            ++ def.level;\r\n            _this.remove();\r\n        }\r\n    };\r\n    //创建内容\r\n    proto.create = function (def, data) {\r\n        for(i = 0; i < data.length; i++){\r\n            var img = tool.createDom('img'),\r\n                attrVal = {};\r\n            attrVal = data[i].isTarg ? {\r\n                'src': 'image/1_09.png',\r\n                'draggable': false,\r\n                'style' : 'width: ' + 100/parseInt(def.hard) + '%',\r\n                'id': i\r\n            }: {\r\n                'src': 'image/1_03.png',\r\n                'draggable': false,\r\n                'style' : 'width: ' + 100/parseInt(def.hard) + '%',\r\n                'id': i\r\n            };\r\n            tool.setAttr(img, attrVal);\r\n            tool.addClass(img, 'rotate90');\r\n            def.content.appendChild(img);\r\n        }\r\n        \r\n    };\r\n    proto.remove = function () {\r\n        var _this = this;\r\n        tool.removeDom(_this.def.content);\r\n        _this.init();\r\n    };\r\n    //点击事件管理\r\n    proto.addEvent = function (data) {\r\n        var _this = this;\r\n        tool.addEvent(data.content, 'click', function (ev) {\r\n            var e = ev || window.event;\r\n            var t = e.target || e.srcElement;\r\n            if (t.nodeName.toLowerCase() === 'img') {\r\n                tool.removeClass(t, 'rotate360');\r\n                tool.addClass(t, 'front');\r\n                setTimeout(function(){\r\n                    // tool.setAttr(t.nextElementSibling, { 'style': 'z-index:2'});\r\n                },350);\r\n            }\r\n            var id = t.parentNode.id;\r\n            _this.score(id);\r\n        });\r\n    };\r\n\r\n\r\n    // 生成随机数\r\n    proto.getRandom = function (h) {\r\n        var a = [];\r\n        var arr = Object.keys(String( Array( h * h + 1)))\r\n            .map( function(e, i){ return i})\r\n            .sort(function () { return 0.5 - Math.random()})\r\n            .slice(0, h)\r\n            .toString();\r\n        // arr = arr.sort(function () { return 0.5 - Math.random()})\r\n        //     .slice(0, h).toString();\r\n        for (i = 0; i < h * h; i++){\r\n            a.push({\r\n                id: i,\r\n                isTarg: !!arr.match(new RegExp('(^|,)' + i + '(,|$)')),\r\n            });\r\n        }\r\n        return a;\r\n    };\r\n    return GameManager;\r\n});\r\n/**\r\n * 工具管理对象\r\n */\r\nvar tool = {\r\n    getDom : function () {\r\n        return document.getElementById(arguments[0]);\r\n    },\r\n    createDom: function () {\r\n        return document.createElement(arguments[0]);\r\n    },\r\n    removeDom: function (ele) {\r\n        while (ele.hasChildNodes()){\r\n            ele.removeChild(ele.lastChild)\r\n        }\r\n    },\r\n    setAttr: function (ele, targ) {\r\n        //targ 为键值对参数，可以同时设置多个参数\r\n        //示例：{ 'id' : '1', 'class': 'xx xx'}\r\n        for (var i in targ){\r\n            ele.setAttribute(i, targ[i]);\r\n        }\r\n        return ele;\r\n    },\r\n    html: function () {\r\n        //传入两条参数修改文本 一条参数获取文本\r\n        return arguments[1] ? ( arguments[0].innerHTML = arguments[1]) : arguments[0].innerHTML;\r\n    },\r\n    hasClass: function (ele, targ) {\r\n        return new RegExp('(^|\\\\s)'+ targ + '(\\\\s|$)').test(ele.className);\r\n    },\r\n    addClass: function (ele, targ) {\r\n        this.hasClass(ele, targ) || (ele.className +=  ' ' + targ);\r\n    },\r\n    removeClass: function (ele, targ) {\r\n        if(this.hasClass(ele, targ)) {\r\n            ele.className = ele.className.replace(new RegExp('(^|\\\\s)' + targ + '(\\\\s|$)'), ' ');\r\n        }\r\n    },\r\n    addAnimation: function (ele, targ) {\r\n        ele.style.animation = targ;\r\n    },\r\n    addEvent: function (ele, type, fn, cap) {\r\n        //cap是否冒泡\r\n        if (ele.addEventListener){\r\n            ele.addEventListener(type, fn, cap || false);\r\n        }else if (ele.attachEvent){\r\n            ele.attachEvent('on' + type, fn);\r\n        }\r\n    },\r\n    removeEVent: function (ele, type, fn) {\r\n        if( ele.removeEventListener) {\r\n            ele.removeEventListener(type, fn, false);\r\n        }else if (ele.detachEvent){\r\n            ele.detachEvent('on' + type, fn);\r\n        }\r\n    },\r\n    delay: function (fn, t) {\r\n        setTimeout(fn, t);\r\n    },\r\n};\r\n\r\nnew GameManager('content');"]}